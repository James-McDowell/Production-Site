{% extends "layout.html" %}
{% block content %}
    <h1 class="mb-3">Posts by {{ user.username }} ({{ posts.total }})</h1>
{% for post in posts.items %}
        <div class="row post-format">
            <div class="col-md-3 pl-0 pr-0">
                <a class="article-title" href="{{ url_for('posts.post', post_id=post.id) }}"><img class="post-picture" src="{{ url_for('static', filename='post_pics/' + post.image_file) }}"></a>
            </div>
            <div class="col-md-9 post-card">
                <div class="card-body">
                   <div class="article-metadata">
                       <a href="{{ url_for('posts.selected_category', category_id=post.categ.id, category_title=post.categ.title) }}"><small class="text-muted">{{ post.categ.title }}</small></a>
                   </div>
                    <h6><a class="article-title" href="{{ url_for('posts.post', post_id=post.id) }}"><b>{{ post.title|truncate(80)|striptags }}</b></a></h6>
                    <a class="article-title" href="{{ url_for('posts.post', post_id=post.id) }}"><small><p class="article-content text-muted">{{ post.content|truncate(140)|striptags }}</p></small></a>
                    <div><a class="mr-2 side_user" href="{{ url_for('users.user_posts', username=post.author.username) }}">{{ post.author.username }}</a></div>
                    <small class="text-muted">{{ post.date_posted.strftime('%Y-%m-%d') }}</small>
                    {% if current_user.is_authenticated %}
                        {% if current_user.has_liked_post(post) %}
                            <small class="float-right"><img class="like" src="{{ url_for('static', filename='home_pics/thumblike.png') }}"> {{ post.likes.count() }}</small>
                          {% else %}
                            <small class="float-right"><img class="like" src="{{ url_for('static', filename='home_pics/thumbunlike.png') }}"> {{ post.likes.count() }}</small>
                          {% endif %}
                    {% else %}
                    <small class="float-right"><img class="like" src="{{ url_for('static', filename='home_pics/thumbunlike.png') }}"> {{ post.likes.count() }}</small>
                    {% endif %}
                </div>

            </div>
        </div>
    {% endfor %}

        <nav aria-label="Page navigation example">
          <ul class="pagination justify-content-center">
            <li class="page-item">
              {% if prev_page %}
                  <a class="page-link" href="{{  url_for('users.user_posts', username=user.username, page=prev_page)}}" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                  </a>
              {% else %}
                  <a class="page-link" aria-label="Previous">
                    <span aria-hidden="true">&laquo;</span>
                    <span class="sr-only">Previous</span>
                  </a>
              {% endif %}
            </li>
            {% for page_num in posts.iter_pages(left_edge=1, right_edge=1, left_current=1, right_current=2) %}
                {% if page_num  %}
                    {% if posts.page == page_num  %}
                        <li class="page-item active"><a class="page-link">{{ page_num }}</a></li>
                    {% else %}
                        <li class="page-item"><a class="page-link" href="{{  url_for('users.user_posts', username=user.username, page=page_num)}}">{{ page_num }}</a></li>
                    {% endif %}
                {% else %}
                    ...
                {% endif %}
            {% endfor %}
            <li class="page-item">
              {% if next_page%}
              <a class="page-link" href="{{  url_for('users.user_posts', username=user.username, page=next_page)}}" aria-label="Next">
                <span aria-hidden="true">&raquo;</span>
                <span class="sr-only">Next</span>
              </a>
              {% else %}
                <a class="page-link" aria-label="Next">
                    <span aria-hidden="true">&raquo;</span>
                    <span class="sr-only">Next</span>
                </a>
              {% endif %}
            </li>
          </ul>
        </nav>



{% endblock content %}